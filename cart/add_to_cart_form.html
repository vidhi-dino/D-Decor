{% if user.is_authenticated %}
<form method="post" action="{% url 'cart:add' %}" class="add-to-cart-form">
    {% csrf_token %}
    <input type="hidden" name="product_name" value="{{ product.item_name }}">
    <input type="hidden" name="product_price" value="{{ product.item_price }}">
    <input type="hidden" name="product_image" value="{{ product.item_image.url }}">
    
    <div class="quantity-selector mb-3">
        <label for="quantity-{{ product.id }}" class="form-label">Quantity:</label>
        <div class="input-group" style="max-width: 150px;">
            <button type="button" class="btn btn-outline-secondary" onclick="decrementQuantity('{{ product.id }}')">-</button>
            <input type="number" id="quantity-{{ product.id }}" name="quantity" class="form-control text-center" 
                   value="1" min="1" max="10" readonly>
            <button type="button" class="btn btn-outline-secondary" onclick="incrementQuantity('{{ product.id }}')">+</button>
        </div>
    </div>
    
    <button type="submit" class="btn btn-primary">
        <i class="bi bi-cart-plus"></i> Add to Cart
    </button>
</form>

<script>
function incrementQuantity(productId) {
    const input = document.getElementById('quantity-' + productId);
    const currentValue = parseInt(input.value);
    if (currentValue < 10) {
        input.value = currentValue + 1;
    }
}

function decrementQuantity(productId) {
    const input = document.getElementById('quantity-' + productId);
    const currentValue = parseInt(input.value);
    if (currentValue > 1) {
        input.value = currentValue - 1;
    }
}
</script>
{% else %}
<p class="text-muted">Please <a href="{% url 'login' %}">login</a> to add items to cart.</p>
{% endif %}